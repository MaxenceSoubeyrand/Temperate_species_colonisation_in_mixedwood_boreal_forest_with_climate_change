662-175
487+180
859.91-509.40
657.45+126
850+783+350
784.3/5
200-169.97
783.45-14.75
126-14.75
4000*1.0465
65000/12
14.95+47.91+164.06+34.04+33.99+8.44+28.77+51.9+113.51+88.51+90.18+18.78
13000*0.04*10/365
13000*0.04
630.4+118.98
7500+12*3*2*500
43500+12*500
500000*45000
29+53
82/2
*1.15
41*1.15
41*1.10
set.seed(42876)
fr_border = sf::st_as_sf(geodata::gadm("GADM", country = "FRA", level = 0))
library(geodata)
install.packages("geodata")
fr_border = sf::st_as_sf(geodata::gadm("GADM", country = "FRA", level = 0))
sf_point = sf::st_sf(sf::st_sample(x = fr_border, size = 25, type = "random"))
climate_data = extract_nc_value(first_year = 2012,
last_year = 2015,
local_file = FALSE,
file_path = NULL,
sml_chunk = "2011-2023",
spatial_extent = fr_border,
clim_variable = "mean temp",
statistic = "mean",
grid_size = 0.25,
ecad_v = NULL,
write_raster = TRUE,
out = "raster_mean_temp.tiff",
return_data = TRUE)
install.packages("climateExtract")
library(climateExtract)
getClimateWizardData(coordinates=c(longitude=10.613975,latitude=34.933439),
scenario="rcp45", start_year=2020, end_year=2050,
metric=c("CD18","R02"), GCMs=c("bcc-csm1-1","BNU-ESM"))
install.packages("climateExtract")
install.packages("chillR")
library(chillR)
getClimateWizardData(coordinates=c(longitude=10.613975,latitude=34.933439),
scenario="rcp45", start_year=2020, end_year=2050,
metric=c("CD18","R02"), GCMs=c("bcc-csm1-1","BNU-ESM"))
install.packages("rclimateca")
devtools::install_github("paleolimbot/rclimateca")
install.packages("rclimateca")
library(tidyverse)
setwd("~/PhD/chap3/new_simulation/data_analysis/video")
res_detailed_adult <- readRDS("~/PhD/chap3/new_simulation/simulation/result_simulations/res_detailed_adult.rds") %>%
filter(climate_scenario=="ssp245",
patch_size=="400",
!is.na(DBH))
res_detailed_sapling <- readRDS("~/PhD/chap3/new_simulation/simulation/result_simulations/res_detailed_sapling.rds") %>%
filter(climate_scenario=="ssp245",
patch_size=="400",
!is.na(DBH))
res <- bind_rows(res_detailed_adult, res_detailed_sapling) %>%
select(-perturbation) %>%
mutate(year=as.numeric(timestep)+1990)
res
res$species <- factor(res$species,
levels = c("Balsam_Fir", "Jack_Pine", "Paper_Birch",
"Trembling_Aspen", "White_Cedar", "White_Spruce",
"Red_Maple", "Sugar_Maple", "Yellow_Birch"),
labels = c("Balsam fir", "Jack pine", "Paper birch",
"Trembling aspen", "White cedar", "White spruce",
"Red Maple", "Sugar Maple", "Yellow Birch"))
res$species_test <- factor(res$species_test,
levels = c("ERR", "ERS", "BOJ"),
labels = c("Red maple", "Sugar maple", "Yellow birch"))
res$fire_year <- factor(res$fire_year,
levels = c("1760", "1823", "1964", "1923"),
labels = c("1760", "1823", "1964", "1923 - Harvested"))
colors <- c("#0077BB", "#33BBEE", "#009988","#EE7733", "#CC3311", "#EE3377", "#882255", "#E6AB02", "#66A61E")
sq <- scales::trans_new("squared", function(x) x^2, sqrt)
res <- res %>%
mutate(`DBH class`=ifelse(DBH<10, "<10","\u2265 10"))
make_plot <- function(){
for(i in sort(unique(res$year))){
p <- ggplot(filter(res, year==i, !species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, size=`DBH class`), color="black") +
scale_size_manual(values=c(0.1, 1)) +
# scale_size_continuous(range=c(0.5,5),
#                       limits=c(0,60.9731),
#                       breaks = c(5, 10, 20, 30, 40, 50),
#                       trans=sq)+
scale_color_manual("Species", values=colors) +
facet_grid(species_test~fire_year) +
annotate("path",
color="red", linewidth=0.7,
x=50+sqrt(400/pi)*cos(seq(0,2*pi,length.out=100)),
y=50+sqrt(400/pi)*sin(seq(0,2*pi,length.out=100)))+
xlim(0,100) + ylim(0,100) +
ggtitle(paste0(i))
ggsave(p, filename=paste0("graph/", i,".png"), width=20, height=13, unit="cm")
}
}
res <- bind_rows(res_detailed_adult, res_detailed_sapling) %>%
select(-perturbation) %>%
mutate(year=as.numeric(timestep)+1990)
res
res$species <- factor(res$species,
levels = c("Balsam_Fir", "Jack_Pine", "Paper_Birch",
"Trembling_Aspen", "White_Cedar", "White_Spruce",
"Red_Maple", "Sugar_Maple", "Yellow_Birch"),
labels = c("Balsam fir", "Jack pine", "Paper birch",
"Trembling aspen", "White cedar", "White spruce",
"Red maple", "Sugar maple", "Yellow birch"))
res$species_test <- factor(res$species_test,
levels = c("ERR", "ERS", "BOJ"),
labels = c("Red maple", "Sugar maple", "Yellow birch"))
res$fire_year <- factor(res$fire_year,
levels = c("1760", "1823", "1964", "1923"),
labels = c("1760", "1823", "1964", "1923 - Harvested"))
colors <- c("#0077BB", "#33BBEE", "#009988","#EE7733", "#CC3311", "#EE3377", "#882255", "#E6AB02", "#66A61E")
sq <- scales::trans_new("squared", function(x) x^2, sqrt)
res <- res %>%
mutate(`DBH class`=ifelse(DBH<10, "<10","\u2265 10"))
make_plot <- function(){
for(i in sort(unique(res$year))){
p <- ggplot(filter(res, year==i, !species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, size=`DBH class`), color="black") +
scale_size_manual(values=c(0.1, 1)) +
# scale_size_continuous(range=c(0.5,5),
#                       limits=c(0,60.9731),
#                       breaks = c(5, 10, 20, 30, 40, 50),
#                       trans=sq)+
scale_color_manual("Species", values=colors) +
facet_grid(species_test~fire_year) +
annotate("path",
color="red", linewidth=0.7,
x=50+sqrt(400/pi)*cos(seq(0,2*pi,length.out=100)),
y=50+sqrt(400/pi)*sin(seq(0,2*pi,length.out=100)))+
xlim(0,100) + ylim(0,100) +
ggtitle(paste0(i))
ggsave(p, filename=paste0("graph/", i,".png"), width=20, height=13, unit="cm")
}
}
make_plot()
thme_set(theme_bw())
theme_set(theme_bw())
make_plot()
res$species[res$species=='Red_Maple'] <- "Temperate species"
res$species[res$species=='Sugar_Maple'] <- "Temperate species"
res$species[res$species=='Yellow_Birch'] <- "Temperate species"
res <- bind_rows(res_detailed_adult, res_detailed_sapling) %>%
select(-perturbation) %>%
mutate(year=as.numeric(timestep)+1990)
res$species[res$species=='Red_Maple'] <- "Temperate species"
res$species[res$species=='Sugar_Maple'] <- "Temperate species"
res$species[res$species=='Yellow_Birch'] <- "Temperate species"
res
res$species <- factor(res$species,
levels = c("Balsam_Fir", "Jack_Pine", "Paper_Birch",
"Trembling_Aspen", "White_Cedar", "White_Spruce",
"Temperate species"),
labels = c("Balsam fir", "Jack pine", "Paper birch",
"Trembling aspen", "White cedar", "White spruce",
"Temperate species"))
res$species_test <- factor(res$species_test,
levels = c("ERR", "ERS", "BOJ"),
labels = c("Red maple", "Sugar maple", "Yellow birch"))
res$fire_year <- factor(res$fire_year,
levels = c("1760", "1823", "1964", "1923"),
labels = c("1760", "1823", "1964", "1923 - Harvested"))
colors <- c("#0077BB", "#33BBEE", "#009988","#EE7733", "#CC3311", "#EE3377", "#882255", "#E6AB02", "#66A61E")
sq <- scales::trans_new("squared", function(x) x^2, sqrt)
res <- res %>%
mutate(`DBH class`=ifelse(DBH<10, "<10","\u2265 10"))
make_plot <- function(){
for(i in sort(unique(res$year))){
p <- ggplot(filter(res, year==i, !species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, size=`DBH class`), color="black") +
scale_size_manual(values=c(0.1, 1)) +
# scale_size_continuous(range=c(0.5,5),
#                       limits=c(0,60.9731),
#                       breaks = c(5, 10, 20, 30, 40, 50),
#                       trans=sq)+
scale_color_manual("Species", values=colors) +
facet_grid(species_test~fire_year) +
annotate("path",
color="red", linewidth=0.7,
x=50+sqrt(400/pi)*cos(seq(0,2*pi,length.out=100)),
y=50+sqrt(400/pi)*sin(seq(0,2*pi,length.out=100)))+
xlim(0,100) + ylim(0,100) +
ggtitle(paste0(i))
ggsave(p, filename=paste0("graph/", i,".png"), width=20, height=13, unit="cm")
}
}
make_plot()
res <- bind_rows(res_detailed_adult, res_detailed_sapling) %>%
select(-perturbation) %>%
mutate(year=as.numeric(timestep)+1990)
res
res$species <- factor(res$species,
levels = c("Balsam_Fir", "Jack_Pine", "Paper_Birch",
"Trembling_Aspen", "White_Cedar", "White_Spruce",
"Temperate species"),
labels = c("Balsam fir", "Jack pine", "Paper birch",
"Trembling aspen", "White cedar", "White spruce",
"Red maple", "Sugar maple", "Yellow birch"))
res$species_test <- factor(res$species_test,
levels = c("ERR", "ERS", "BOJ"),
labels = c("Red maple", "Sugar maple", "Yellow birch"))
res$fire_year <- factor(res$fire_year,
levels = c("1760", "1823", "1964", "1923"),
labels = c("1760", "1823", "1964", "1923 - Harvested"))
res <- bind_rows(res_detailed_adult, res_detailed_sapling) %>%
select(-perturbation) %>%
mutate(year=as.numeric(timestep)+1990)
res
res$species <- factor(res$species,
levels = c("Balsam_Fir", "Jack_Pine", "Paper_Birch",
"Trembling_Aspen", "White_Cedar", "White_Spruce",
"Temperate species"),
labels = c("Balsam fir", "Jack pine", "Paper birch",
"Trembling aspen", "White cedar", "White spruce",
"Red maple", "Sugar maple", "Yellow birch"))
res <- bind_rows(res_detailed_adult, res_detailed_sapling) %>%
select(-perturbation) %>%
mutate(year=as.numeric(timestep)+1990)
res
res$species <- factor(res$species,
levels = c("Balsam_Fir", "Jack_Pine", "Paper_Birch",
"Trembling_Aspen", "White_Cedar", "White_Spruce",
"Red_Maple", "Sugar_Maple", "Yellow_Birch"),
labels = c("Balsam fir", "Jack pine", "Paper birch",
"Trembling aspen", "White cedar", "White spruce",
"Red maple", "Sugar maple", "Yellow birch"))
res$species_test <- factor(res$species_test,
levels = c("ERR", "ERS", "BOJ"),
labels = c("Red maple", "Sugar maple", "Yellow birch"))
res$fire_year <- factor(res$fire_year,
levels = c("1760", "1823", "1964", "1923"),
labels = c("1760", "1823", "1964", "1923 - Harvested"))
colors <- c("#0077BB", "#33BBEE", "#009988","#EE7733", "#CC3311", "#EE3377", "#882255", "#E6AB02", "#66A61E")
sq <- scales::trans_new("squared", function(x) x^2, sqrt)
res <- res %>%
mutate(`DBH class`=ifelse(DBH<10, "<10","\u2265 10"))
make_plot <- function(){
for(i in sort(unique(res$year))){
p <- ggplot(filter(res, year==i, !species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Red Maple", "Sugar Maple", "Yellow Birch")),
aes(x=X, y=Y, size=`DBH class`), color="black") +
scale_size_manual(values=c(0.1, 1)) +
# scale_size_continuous(range=c(0.5,5),
#                       limits=c(0,60.9731),
#                       breaks = c(5, 10, 20, 30, 40, 50),
#                       trans=sq)+
scale_color_manual("Species", values=colors) +
facet_grid(species_test~fire_year) +
annotate("path",
color="red", linewidth=0.7,
x=50+sqrt(400/pi)*cos(seq(0,2*pi,length.out=100)),
y=50+sqrt(400/pi)*sin(seq(0,2*pi,length.out=100)))+
xlim(0,100) + ylim(0,100) +
ggtitle(paste0(i))
ggsave(p, filename=paste0("graph/", i,".png"), width=20, height=13, unit="cm")
}
}
make_plot()
ggsave(p, filename=paste0("graph/", i,".png"), width=20, height=13, unit="cm")
make_plot <- function(){
for(i in sort(unique(res$year))){
p <- ggplot(filter(res, year==i, !species %in% c("Red maple", "Sugar maple", "Yellow birch")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Red maple", "Sugar maple", "Yellow birch")),
aes(x=X, y=Y, size=`DBH class`), color="black") +
scale_size_manual(values=c(0.1, 1)) +
# scale_size_continuous(range=c(0.5,5),
#                       limits=c(0,60.9731),
#                       breaks = c(5, 10, 20, 30, 40, 50),
#                       trans=sq)+
scale_color_manual("Species", values=colors) +
facet_grid(species_test~fire_year) +
annotate("path",
color="red", linewidth=0.7,
x=50+sqrt(400/pi)*cos(seq(0,2*pi,length.out=100)),
y=50+sqrt(400/pi)*sin(seq(0,2*pi,length.out=100)))+
xlim(0,100) + ylim(0,100) +
ggtitle(paste0(i))
ggsave(p, filename=paste0("graph/", i,".png"), width=20, height=13, unit="cm")
}
}
make_plot()
res <- bind_rows(res_detailed_adult, res_detailed_sapling) %>%
select(-perturbation) %>%
mutate(year=as.numeric(timestep)+1990)
res$species[res$species=='Red_Maple'] <- "Temperate species"
res$species[res$species=='Sugar_Maple'] <- "Temperate species"
res$species[res$species=='Yellow_Birch'] <- "Temperate species"
res
res$species <- factor(res$species,
levels = c("Balsam_Fir", "Jack_Pine", "Paper_Birch",
"Trembling_Aspen", "White_Cedar", "White_Spruce",
"Temperate species"),
labels = c("Balsam fir", "Jack pine", "Paper birch",
"Trembling aspen", "White cedar", "White spruce",
"Temperate species"))
res$species_test <- factor(res$species_test,
levels = c("ERR", "ERS", "BOJ"),
labels = c("Red maple", "Sugar maple", "Yellow birch"))
res$fire_year <- factor(res$fire_year,
levels = c("1760", "1823", "1964", "1923"),
labels = c("1760", "1823", "1964", "1923 - Harvested"))
colors <- c("#0077BB", "#33BBEE", "#009988","#EE7733", "#CC3311", "#EE3377", "#882255", "#E6AB02", "#66A61E")
sq <- scales::trans_new("squared", function(x) x^2, sqrt)
res <- res %>%
mutate(`DBH class`=ifelse(DBH<10, "<10","\u2265 10"))
make_plot <- function(){
for(i in sort(unique(res$year))){
p <- ggplot(filter(res, year==i, !species %in% c("Temperate species")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Temperate species")),
aes(x=X, y=Y, size=`DBH class`), color="black") +
scale_size_manual(values=c(0.1, 1)) +
# scale_size_continuous(range=c(0.5,5),
#                       limits=c(0,60.9731),
#                       breaks = c(5, 10, 20, 30, 40, 50),
#                       trans=sq)+
scale_color_manual("Species", values=colors) +
facet_grid(species_test~fire_year) +
annotate("path",
color="red", linewidth=0.7,
x=50+sqrt(400/pi)*cos(seq(0,2*pi,length.out=100)),
y=50+sqrt(400/pi)*sin(seq(0,2*pi,length.out=100)))+
xlim(0,100) + ylim(0,100) +
ggtitle(paste0(i))
ggsave(p, filename=paste0("graph/", i,".png"), width=20, height=13, unit="cm")
}
}
make_plot()
gplot(filter(res, year==i, !species %in% c("Temperate species")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point()
ggplot(filter(res, year==i, !species %in% c("Temperate species")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point()
sort(unique(res$year))
i="1990"
i=1990
ggplot(filter(res, year==i, !species %in% c("Temperate species")),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point()
filter(res, year==i),
ggplot(filter(res, year==i),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point()
p <- ggplot(filter(res, year==i),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Temperate species")),
aes(x=X, y=Y, size=`DBH class`), color="black") +
scale_size_manual(values=c(0.1, 1)) +
# scale_size_continuous(range=c(0.5,5),
#                       limits=c(0,60.9731),
#                       breaks = c(5, 10, 20, 30, 40, 50),
#                       trans=sq)+
scale_color_manual("Species", values=colors) +
facet_grid(species_test~fire_year) +
annotate("path",
color="red", linewidth=0.7,
x=50+sqrt(400/pi)*cos(seq(0,2*pi,length.out=100)),
y=50+sqrt(400/pi)*sin(seq(0,2*pi,length.out=100)))+
xlim(0,100) + ylim(0,100) +
ggtitle(paste0(i))
ggplot(filter(res, year==i),
aes(x=X, y=Y, color=species, size=`DBH class`)) +
geom_point() +
geom_point(data=filter(res, year==i, species %in% c("Temperate species")),
aes(x=X, y=Y, size=`DBH class`), color="black")
